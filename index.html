<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FanWorld Feed & Post</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;700&display=swap" rel="stylesheet">
<style>
*, *:before, *:after { box-sizing: border-box; }
html, body { max-width: 100%; overflow-x: hidden; -webkit-text-size-adjust: 100%; }
body, header, input, .container, .main-feed-flex, .posts-column, .welcome-box, .welcome-box h2, .welcome-box p, .post-title, .post-text, .post-actions, .back-btn, .credit, .similar-posts-section, .similar-posts-title, .similar-post-card { font-family: 'Barlow', Arial, sans-serif !important; }
body { background: #fff; margin: 0; color: #222; }
header { display: flex; justify-content: space-between; align-items: center; padding: 18px 24px; background: #e0d7c3; color: #222; box-shadow: 0 2px 10px #0001; }
#siteTitle { font-weight: 700; font-size: 1.6rem; letter-spacing: 0.04em; }
input, textarea, select, button { font-size: 16px; }
#searchBar { padding: 8px 14px; font-size: 1rem; border-radius: 7px; border: 1px solid #bbb; width: 220px; transition: border-color 0.2s; outline: none; background: #fff;}
#searchBar:focus { border-color: #b69967; }
.container { padding: 28px 14px; max-width: 940px; margin: 28px auto 0 auto; background: #fff; border-radius: 14px; min-height: 330px; }
.main-feed-flex { display: flex; flex-direction: row; align-items: flex-start; gap: 20px; position: relative; min-height: 330px; background: #fff; }

/* Policy modal */
#policyModal { position: fixed; inset: 0; background: rgba(0,0,0,0.45); z-index: 9999; display: flex; align-items: center; justify-content: center; }
#policyModal .modal-inner { background: #fff; padding: 20px; border-radius: 12px; max-width: 92vw; width: 420px; box-shadow: 0 8px 32px rgba(0,0,0,0.18); font-family: 'Barlow', sans-serif; }
#policyModal h2 { margin-top: 0; font-size: 1.05rem; }
#policyModal p { margin-bottom: 12px; font-size: 0.98rem; }
#policyModal label { display: flex; align-items: center; gap: 8px; font-size: 0.98rem; }
#policyModal button { padding: 9px 16px; border-radius: 8px; background: #b69967; color: #fff; border: none; font-weight: 700; cursor: pointer; }

/* Post tile and card CSS for Pinterest-style layout */
.post-tile, .similar-post-card {
  position: relative;
  cursor: pointer;
  border-radius: 12px;
  overflow: hidden;
  margin-bottom: 16px;
  display: inline-block;
  width: 100%;
}
/* Force all images (Post A & B if used) to same height */
.tile-img, .similar-thumb {
  width: 100%;
  height: 220px; /* fixed height for uniformity */
  object-fit: cover;
  border-radius: 12px;
}

/* Overlay at bottom of image */
.tile-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  background: rgba(0,0,0,0.55);
  color: #fff;
  padding: 8px 10px;
  line-height: 1.2;
}
.tile-overlay span:first-child { font-weight: 700; font-size: 1rem; display: block; }
.tile-overlay span:last-child { font-weight: 400; font-size: 0.85rem; display: block; }

.post-card { border-radius: 12px; overflow: hidden; background: #fefefe; padding: 12px; box-shadow: 0 2px 10px #0001; }
.back-btn { background: #b69967; color: #fff; border: none; border-radius: 8px; padding: 8px 12px; cursor: pointer; margin-bottom: 12px; }

/* Masonry layout */
#postsList, .similar-posts-list { column-count: 3; column-gap: 16px; }
@media(max-width: 1020px){ #postsList, .similar-posts-list { column-count: 2; } }
@media(max-width: 600px){ #postsList, .similar-posts-list { column-count: 1; } }

/* Post Type B beige box */
.post-tile-b {
  background: #e8dcc5; /* beige box */
  color: #fff; /* white text */
  border-radius: 12px;
  padding: 20px;
  height: 220px; /* same size as image posts */
  display: flex;
  flex-direction: column;
  justify-content: center;
  cursor: pointer;
  margin-bottom: 16px;
  text-align: center;
  font-weight: 700;
  font-size: 1.05rem;
}
.post-tile-b span {
  display: block;
  margin-top: 6px;
  font-size: 0.9rem;
  font-weight: 400;
}
</style>
</head>
<body>

<!-- FanWorld Policy Modal -->
<div id="policyModal" aria-hidden="false">
  <div class="modal-inner">
    <h2>FanWorld Policy</h2>
    <p>I agree to the FanWorld Policy: All content is properly credited, shared only for sweet entertainment and enjoyment, not intended to harm anyone or any platform. I understand I can only access FanWorld after agreeing. <strong>Sweet enjoyment is the goal!</strong></p>
    <div style="margin-bottom:12px;">
      <label><input type="checkbox" id="agreeBox"> I agree to the FanWorld Policy.</label>
    </div>
    <div style="text-align:right;"><button id="agreeBtn" disabled>Enter FanWorld</button></div>
  </div>
</div>

<header>
  <div id="siteTitle">FanWorld</div>
  <input id="searchBar" placeholder="Search..." />
</header>

<div class="container main-feed-flex" id="mainFeed">
  <div class="posts-column">
    <div id="postsList"></div>
  </div>
  <div class="welcome-box">
    <h2>Welcome to FanWorld!</h2>
    <p>Browse the latest posts. Click a post to see details!</p>
  </div>
</div>

<div class="container" style="display:none;" id="singlePostView"></div>

<script>
const policyModal=document.getElementById('policyModal');
const agreeBox=document.getElementById('agreeBox');
const agreeBtn=document.getElementById('agreeBtn');
function openPolicy(){ policyModal.style.display='flex'; policyModal.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }
function closePolicy(){ policyModal.style.display='none'; policyModal.setAttribute('aria-hidden','true'); document.body.style.overflow=''; }
agreeBox.addEventListener('change',()=>{agreeBtn.disabled=!agreeBox.checked;});
agreeBtn.addEventListener('click',()=>{closePolicy();});
window.addEventListener('DOMContentLoaded',()=>{openPolicy();});

// Posts array (Post A + Post B)
const posts=[
  // NEW Post Type B — added at top
  {id:21,type:'B',title:'The new couple in town out of BB19',celebrity:'Natalia Janoszek and Mridul Tiwari',externalLink:'https://www.instagram.com/p/DRfHd9FjXwe/'},

  // Existing Post A
  {id:1,type:'A',image:'https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=640',title:'Cheer Squad',celebrity:'Taylor Swift',text:'Swifties unite at the world tour!',credit:'Photo by Alex Brown',creditUrl:'https://unsplash.com/photos/1506744038136-46273834b3fb'},
  {id:3,type:'A',image:'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?w=640',title:'Rock On',celebrity:'Beyoncé',text:'A sea of lights from Queen Bey\'s fans!',credit:'Photo by Jessica Wu'},
  {id:4,type:'A',image:'https://images.unsplash.com/photo-1416339306562-f3d12fefd36f?w=640',title:'Football Fever',celebrity:'Lionel Messi',text:'Messi fans everywhere show team spirit.',credit:'Unsplash / UnsplashSports',creditUrl:'https://unsplash.com/'},
  {id:5,type:'A',image:'https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=640',title:'Iconic Night',celebrity:'Billie Eilish',text:'Billie fans go wild at concert event.',credit:'Photo by Ben Oliver'},
  {id:6,type:'B',image:'https://via.placeholder.com/640x480.png?text=Instagram+Screenshot',title:'Amazing Reel',celebrity:'Charli D’Amelio',text:'Check this out on Instagram!',externalLink:'https://www.instagram.com/p/CODE123/'},
  {id:7,type:'B',image:'https://via.placeholder.com/640x480.png?text=TikTok+Screenshot',title:'Viral Dance',celebrity:'Addison Rae',text:'Watch the original on TikTok!',externalLink:'https://www.tiktok.com/@addison/video/1234567890'}
];

let currentPost=null,lastViewedPostId=null;

function renderGrid(postsArr){
  const postsList=document.getElementById('postsList');
  postsList.innerHTML=postsArr.map(post => {
    if (post.type === 'A') {
      return `
        <div class="post-tile" onclick="showPost(${post.id})">
          <img class="tile-img" src="${escapeHtml(post.image)}" alt="${escapeHtml(post.title)}">
          <div class="tile-overlay">
            <span>${escapeHtml(post.title)}</span>
            <span>${escapeHtml(post.celebrity)}</span>
          </div>
        </div>
      `;
    } else {
      return `
        <div class="post-tile-b" onclick="window.open('${escapeHtml(post.externalLink)}','_blank')">
          ${escapeHtml(post.title)}
          <span>${escapeHtml(post.celebrity)}</span>
        </div>
      `;
    }
  }).join('');
}

function showPost(id){
  const post=posts.find(p=>p.id===id);
  if(!post) return;
  currentPost=post;
  lastViewedPostId=id;
  document.getElementById('mainFeed').style.display='none';
  const creditSection=post.type==='A'
    ? `<div class="credit">Credit: ${post.creditUrl?`<a href="${escapeHtml(post.creditUrl)}" target="_blank" rel="noopener">${escapeHtml(post.credit)}</a>`:escapeHtml(post.credit||'Unknown')}</div>`
    : ''; // Post B opens link directly
  document.getElementById('singlePostView').innerHTML=`
    <button class="back-btn" onclick="goBack()">← Back</button>
    <div class="post-card">
      ${post.type==='A'?`<img class="tile-img single" src="${escapeHtml(post.image)}" alt="${escapeHtml(post.title)}">`:''}
      <div class="celebrity-credit">${escapeHtml(post.celebrity)}</div>
      <div class="post-title">${escapeHtml(post.title)}</div>
      ${creditSection}
      <div class="post-text">${escapeHtml(post.text||'')}</div>
    </div>
    ${post.type==='A'?`
    <div class="similar-posts-section">
      <div class="similar-posts-title">Similar posts:</div>
      <div class="similar-posts-list">${renderSimilarPosts(post.id)}</div>
    </div>`:''}
  `;
  document.getElementById('singlePostView').style.display='block';
}

function goBack(){ document.getElementById('mainFeed').style.display='flex'; document.getElementById('singlePostView').style.display='none'; }

function renderSimilarPosts(currentId){
  return posts.filter(p=>p.id!==currentId).map(p=>`
    <div class="similar-post-card" onclick="showPost(${p.id})">
      <img class="similar-thumb" src="${escapeHtml(p.image)}" alt="${escapeHtml(p.title)}">
      <div class="tile-overlay">
        <span>${escapeHtml(p.title)}</span>
        <span>${escapeHtml(p.celebrity)}</span>
      </div>
    </div>
  `).join('');
}

function escapeHtml(str){ if(!str && str!==0) return ''; return String(str).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#39;'); }

// Search for main feed & similar posts
const searchInput=document.getElementById('searchBar');
let searchTimer=null;
if(searchInput){ searchInput.addEventListener('keyup',()=>{
  clearTimeout(searchTimer);
  searchTimer=setTimeout(()=>{
    const query=searchInput.value.toLowerCase();
    const filtered=posts.filter(p=>p.title.toLowerCase().includes(query)||p.celebrity.toLowerCase().includes(query));
    if(document.getElementById('mainFeed').style.display!=='none'){ renderGrid(filtered); }
    if(document.getElementById('singlePostView').style.display!=='none'){
      const similarList=document.querySelector('.similar-posts-list');
      if(similarList){ similarList.innerHTML=filtered.filter(p=>p.id!==lastViewedPostId).map(p=>`
        <div class="similar-post-card" onclick="showPost(${p.id})">
          <img class="similar-thumb" src="${escapeHtml(p.image)}" alt="${escapeHtml(p.title)}">
          <div class="tile-overlay">
            <span>${escapeHtml(p.title)}</span>
            <span>${escapeHtml(post.celebrity)}</span>
          </div>
        </div>
      `).join(''); }
    }
  },300);
}); }

document.addEventListener('DOMContentLoaded',()=>{ renderGrid(posts); });
</script>
</body>
</html>
