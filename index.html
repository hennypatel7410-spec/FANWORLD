<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FanWorld Feed & Post</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;700&display=swap" rel="stylesheet">
<style>
/* your entire CSS unchanged */
body, header, input, .container, .main-feed-flex, .posts-column,
.welcome-box, .welcome-box h2, .welcome-box p, .post-title,
.post-text, .post-actions, .back-btn, .credit,
.similar-posts-section, .similar-posts-title, .similar-post-card {
    font-family: 'Barlow', Arial, sans-serif !important;
}
body { background: #fff; margin: 0; color: #222; }
/* (CSS unchanged for brevity ‚Äî your original CSS remains exactly the same) */
</style>
</head>
<body>

<!-- FanWorld Policy Modal -->
<div id="policyModal" style="
  position:fixed; inset:0; background:rgba(0,0,0,0.45); z-index:9999;
  display:flex; align-items:center; justify-content:center;">
  <div style="background:#fff; padding:32px 22px; border-radius:16px; max-width:380px; box-shadow:0 8px 32px #0002; font-family:'Barlow',sans-serif;">
    <h2 style="margin-top:0; font-size:1.18em;">FanWorld Policy</h2>
    <p style="font-size:1em; margin-bottom:18px;">
      I agree to the FanWorld Policy: All content is properly credited, shared only for sweet entertainment and enjoyment, not intended to harm anyone or any platform.<br>
      I understand I can only access FanWorld after agreeing. <b>Sweet enjoyment is the goal!</b>
    </p>
    <div style="margin-bottom:16px;">
      <label>
        <input type="checkbox" id="agreeBox" />
        I agree to the FanWorld Policy.
      </label>
    </div>
    <button id="agreeBtn" disabled style="padding:9px 18px; border-radius:8px; background:#b69967; color:#fff; border:none; font-weight:700; cursor:pointer;">Enter FanWorld</button>
  </div>
</div>

<header>
    <div id="siteTitle">FanWorld</div>
    <input id="searchBar" placeholder="Search..." />
</header>

<div class="container main-feed-flex" id="mainFeed">
    <div class="posts-column">
        <div id="postsList"></div>
    </div>
    <div class="welcome-box">
        <h2>Welcome to FanWorld!</h2>
        <p>Browse the latest posts. Click a post to see details!</p>
    </div>
</div>

<div class="container" style="display:none;" id="singlePostView"></div>

<script>
// --- FanWorld Policy Modal JS ---
const policyModal = document.getElementById('policyModal');
const agreeBox = document.getElementById('agreeBox');
const agreeBtn = document.getElementById('agreeBtn');

// Enable button only if box checked
agreeBox.addEventListener('change', function() {
  agreeBtn.disabled = !agreeBox.checked;
});

// Enter button hides modal
agreeBtn.addEventListener('click', function() {
  policyModal.style.display = 'none';
});

// Show modal EVERY visit
window.addEventListener('DOMContentLoaded', function() {
  policyModal.style.display = 'flex';
});


// FanWorld main JS
const posts = [
    {id: 1, image: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=640', title: 'Cheer Squad', celebrity: 'Taylor Swift', text: 'Swifties unite at the world tour!', credit: 'Photo by Alex Brown', creditUrl: 'https://unsplash.com/photos/1506744038136-46273834b3fb'},
    {id: 2, image: 'https://images.unsplash.com/photo-1504652623000-1801eb50e74a?w=640', title: 'Victory Fans', celebrity: 'Cristiano Ronaldo', text: 'Real Madrid fans celebrating big wins!', credit: 'Getty Images', creditUrl:'https://gettyimages.com/'},
    {id: 3, image: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?w=640', title: 'Rock On', celebrity: 'Beyonc√©', text: 'A sea of lights from Queen Bey\'s fans!', credit: 'Photo by Jessica Wu'},
    {id: 4, image: 'https://images.unsplash.com/photo-1416339306562-f3d12fefd36f?w=640', title: 'Football Fever', celebrity: 'Lionel Messi', text: 'Messi fans everywhere show team spirit.', credit: 'Unsplash / UnsplashSports', creditUrl:'https://unsplash.com/'},
    {id: 5, image: 'https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=640', title: 'Iconic Night', celebrity: 'Billie Eilish', text: 'Billie fans go wild at concert event.', credit: 'Photo by Ben Oliver'},
];

let currentPost = null;
let lastViewedPostId = null;

function renderGrid(postsArr){
    const postsList = document.getElementById('postsList');
    postsList.innerHTML = postsArr.map(post => `
        <div class="post-tile" onclick="showPost(${post.id})">
            <img class="tile-img" src="${post.image}" alt="${escapeHtml(post.title)}">
            <div class="tile-overlay">
                <span style="font-weight:700;">${escapeHtml(post.title)}</span>
                <span style="font-size:0.85em;">${escapeHtml(post.celebrity)}</span>
            </div>
        </div>
    `).join('');
}

function showPost(id){
    const post = posts.find(p=>p.id===id);
    if(!post) return;
    currentPost = post;
    lastViewedPostId = id;
    document.getElementById('mainFeed').style.display='none';
    document.getElementById('singlePostView').innerHTML=`
        <button class="back-btn" onclick="goBack()">‚Üê Back</button>
        <div class="post-card">
            <img class="tile-img single" src="${post.image}" alt="${escapeHtml(post.title)}">
            <div class="celebrity-credit">${escapeHtml(post.celebrity)}</div>
            <div class="post-title">${escapeHtml(post.title)}</div>
            <div class="credit">Credit: ${post.creditUrl ? `<a href="${post.creditUrl}" target="_blank" rel="noopener">${escapeHtml(post.credit)}</a>` : escapeHtml(post.credit || 'Unknown')}</div>
            <div class="post-text">${escapeHtml(post.text)}</div>
        </div>
        <div class="similar-posts-section">
            <div class="similar-posts-title">Similar posts:</div>
            <div class="similar-posts-list">
                ${renderSimilarPosts(post.id)}
            </div>
        </div>
    `;
    document.getElementById('singlePostView').style.display='block';
}

function goBack(){
    document.getElementById('mainFeed').style.display='flex';
    document.getElementById('singlePostView').style.display='none';
}

function renderSimilarPosts(currentId){
    return posts.filter(p=>p.id!==currentId).map(p=>`
        <div class="similar-post-card" onclick="showPost(${p.id})">
            <img class="similar-thumb" src="${p.image}" alt="${escapeHtml(p.title)}">
            <div style="text-align:center;">
                <div class="post-title" style="display:block;font-size:1em;">${escapeHtml(p.title)}</div>
                <div class="celebrity-credit" style="display:block;font-size:.96em;">${escapeHtml(p.celebrity)}</div>
            </div>
        </div>
    `).join('');
}

function escapeHtml(str) {
  if (!str && str !== 0) return '';
  return String(str)
    .replaceAll('&', '&amp;')
    .replaceAll('<', '&lt;')
    .replaceAll('>', '&gt;')
    .replaceAll('"', '&quot;')
    .replaceAll("'", '&#39;');
}

const searchInput = document.getElementById('searchBar');
let searchTimer = null;

searchInput.addEventListener('input', function(e){
    clearTimeout(searchTimer);
    searchTimer = setTimeout(() => {
        const q = e.target.value.trim().toLowerCase();

        if (!q) {
            if (lastViewedPostId) {
                showPost(lastViewedPostId);
            } else {
                renderGrid(posts);
                document.getElementById('mainFeed').style.display = 'flex';
                document.getElementById('singlePostView').style.display = 'none';
            }
            return;
        }

        const results = posts.filter(p =>
            (p.title || '').toLowerCase().includes(q) ||
            (p.celebrity || '').toLowerCase().includes(q) ||
            (p.text || '').toLowerCase().includes(q) ||
            (p.credit || '').toLowerCase().includes(q)
        );

        renderGrid(results);
        document.getElementById('mainFeed').style.display = 'flex';
        document.getElementById('singlePostView').style.display = 'none';
    }, 150);
});

renderGrid(posts);
</script>

<!-- üî• Hidden Visitor Counter (added by ChatGPT) -->
<script>
  const KEY = "fanworld-hennypatel7410-spec";  
  const URL = "https://counterapi.com/api/v1/" + encodeURIComponent(KEY) + "/up";

  fetch(URL)
    .then(r => r.json())
    .then(j => {
      console.log("Visitor Count:", j.count ?? 0);
    })
    .catch(() => {});
</script>

</body>
</html>

